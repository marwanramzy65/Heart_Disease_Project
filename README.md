# ‚ù§Ô∏è Heart Disease Prediction ‚Äì Machine Learning & Streamlit Deployment

## üìå Overview
This project builds a **machine learning pipeline** to predict the risk of heart disease based on patient medical data.  
It covers **data preprocessing, exploratory analysis, feature selection, model training, evaluation, and deployment** via Streamlit with Ngrok and Hugging Face Space(https://marwanramzy-heartdisease.hf.space/) for public access .

---

## üìÇ Repository Structure
```
Heart_Disease_Project/
‚îÇ‚îÄ‚îÄ data/
‚îÇ ‚îú‚îÄ‚îÄ processed.cleveland.csv
‚îÇ‚îÄ‚îÄ notebooks/
‚îÇ ‚îú‚îÄ‚îÄ heart_disease (5).ipynb
‚îÇ‚îÄ‚îÄ models/
‚îÇ ‚îú‚îÄ‚îÄ heart_pipeline.pkl
‚îÇ‚îÄ‚îÄ UI/
‚îÇ ‚îú‚îÄ‚îÄ app2.py # Streamlit UI
‚îÇ‚îÄ‚îÄ deployment/
‚îÇ ‚îú‚îÄ‚îÄ ngrok.txt
‚îÇ‚îÄ‚îÄ results/
‚îÇ ‚îú‚îÄ‚îÄ evaluation_metrics.txt
‚îÇ‚îÄ‚îÄ README.md
‚îÇ‚îÄ‚îÄ requirements.txt
‚îÇ‚îÄ‚îÄ .gitignore
```


## üìä Dataset
The dataset contains patient health metrics such as:

| Feature            | Description |
|--------------------|-------------|
| `age`              | Age in years |
| `sex`              | 0 = Female, 1 = Male |
| `cp`               | Chest pain type |
| `trestbps`         | Resting blood pressure (mm Hg) |
| `chol`             | Serum cholesterol (mg/dl) |
| `fbs`              | Fasting blood sugar > 120 mg/dl |
| `restecg`          | Resting ECG results |
| `thalach`          | Maximum heart rate achieved |
| `exang`            | Exercise-induced angina |
| `oldpeak`          | ST depression induced by exercise |
| `slope`            | Slope of the peak exercise ST segment |
| `ca`               | Number of major vessels (0‚Äì3) colored by fluoroscopy |
| `thal`             | Thalassemia type |
| **Target**         | `1` = Heart disease, `0` = No disease |

---

## ‚öôÔ∏è Project Workflow

### **1Ô∏è‚É£ Data Preprocessing**
- Load dataset into a Pandas DataFrame.
- Handle missing values and clean data.
- Encode categorical features.
- Split data into **features (X)** and **target (y)**.
- Apply **StandardScaler** to normalize numerical features.

### **2Ô∏è‚É£ Exploratory Data Analysis (EDA)**
- Visualize distributions using histograms and boxplots.
- Generate correlation heatmaps to detect relationships.
- Use count plots for categorical feature insights.

### **3Ô∏è‚É£ Feature Selection**
- **Random Forest Importance** ‚Üí Identify key predictive features.
- **Recursive Feature Elimination (RFE)** ‚Üí Iteratively remove less important features.

### **4Ô∏è‚É£ Dimensionality Reduction**
- Apply **Principal Component Analysis (PCA)** to reduce dimensionality while retaining most of the data variance.

### **5Ô∏è‚É£ Model Training & Evaluation**
Trained and compared the following algorithms:
- Logistic Regression
- Random Forest Classifier
- Support Vector Machine (SVM)
- GradientBoosting

**Evaluation Metrics:**
- Accuracy
- Confusion Matrix
- Classification Report (Precision, Recall, F1-Score)

### **6Ô∏è‚É£ Unsupervised Learning ‚Äì Clustering**
Steps:
1. **K-Means Clustering** (Elbow Method to determine optimal `K`).
2. **Hierarchical Clustering** (Dendrogram analysis).
3. Compare predicted clusters with actual disease labels.

**Deliverable:** Clustering models with visualized results.

### **7Ô∏è‚É£ Hyperparameter Tuning**
Steps:
1. Use **GridSearchCV** & **RandomizedSearchCV** to optimize model hyperparameters.
2. Compare optimized models with baseline performance.

### **6Ô∏è‚É£ Model Saving**
- Export the final model as a `.joblib` file to reuse in the deployment phase.

### **7Ô∏è‚É£ Streamlit App Development**
- Built a web-based UI using Streamlit.
- Users enter medical details to receive **real-time predictions**.
- Displays results and explanations.

### **8Ô∏è‚É£ Ngrok Deployment**
- Ngrok creates a **public URL** for the Streamlit app.
- Steps:
  1. Install `pyngrok`
  2. Authenticate with your Ngrok token
  3. Run Streamlit locally
  4. Share public link generated by Ngrok

## üöÄ Installation & Usage

### **Requirements**
```bash
pip install pandas numpy scikit-learn matplotlib seaborn streamlit joblib pyngrok
